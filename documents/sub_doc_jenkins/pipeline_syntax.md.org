
pipeline{
    agent any
    //1,用于设置环境变量，可定义在stage或pipeline部分。
    environment{
        CC = 'clang'
    }
    //2,它会自动下载并安装我们指定的工具，并将其加入PATH变量中。可定义在pipeline或stage部分。
    tools{

    }
    //3,用于配置Jenkins pipeline本身的选项。可定义在stage或pipeline部分。
    options{
        buildDiscarder() //1,保存最近历史构建记录的数量。此选项只能在pipeline下的options中使用。
        checkoutToSubdirectory() //2,Jenkins从版本控制库拉取源码时，默认检出到工作空间的根目录中，此选项可以指定检出到工作空间的子目录中。
        disableConcurrentBuilds() //3,同一个pipeline，Jenkins默认是可以同时执行多次的，此选项是为了禁止pipeline同时执行。
        newContainerPerStage() //4,当agent为docker或dockerfile时，指定在同一个Jenkins节点上，每个stage都分别运行在一个新的容器中，而不是所有stage都运行在同一个容器中。
        retry() //5,当发生失败时进行重试，可以指定整个pipeline的重试次数。需要注意的是，这个次数是指总次数，包括第1次失败。
        timrout() //6,如果 pipeline 执行时间过长，超出了我们设置的 timeout 时间，Jenkins 将中止pipeline。
    }
    //4,并行执行多个step。
    parallel{

    }
    //5,parameters是执行pipeline前传入的一些参数。
    parameters{

    }
    //7,用于定义执行pipeline的触发器。
    triggers{

    }
    //8,当满足when定义的条件时，阶段才执行。
    when{

    }

    stages{
        stage("name1"){
            //1,用于设置环境变量，可定义在stage或pipeline部分。
            environment{
                DEBUG_FLAG = '-g'
            }
            //2,它会自动下载并安装我们指定的工具，并将其加入PATH变量中。可定义在pipeline或stage部分。
            tools{

            }
            //3,会暂停pipeline，提示你输入内容。定义在stage部分。
            input{

            }
            //3,用于配置Jenkins pipeline本身的选项。可定义在stage或pipeline部分。
            options{

            }
            steps{
                
                //在script块中的其实就是Groovy代码。
                srcipt{
                }
                deleteDir：是一个无参步骤，删除的是当前工作目录。通常它与dir步骤一起使用。
                dir：切换到其他目录。
                fileExists：判断文件是否存在。结果返回布尔类型。
                isUnix：判断是否为类UNIX系统，如果当前pipeline运行在一个类UNIX系统上，则返回true。
                pwd：pwd与Linux的pwd命令一样，返回当前所在目录。
                writeFile：将内容写入指定文件中，参数writeFile(file,text,encoding),
                readFile：读取文件内容，readFile(fileencoding),
                stash：保存临时文件，stash(name，allowEmpty，excludes，includes)，可以将一些文件保存起来，以便被同一次构建的其他步骤或阶段使用。通常需要stash的文件都是要跨Jenkins node使用的。
                unstash：取出之前stash的文件
            }

        }
        stage("name2"){


        }

    }
    post{
        //1,不论当前完成状态是什么，都执行。
        always{

        }
        //2,只要当前完成状态与上一次完成状态不同就执行。
        changed{
            
        }
        //3,上一次完成状态为失败或不稳定（unstable），当前完成状态为成功时执行。
        fixed{

        }
        //4,上一次完成状态为成功，当前完成状态为失败、不稳定或中止（aborted）时执行。
        regression{

        }
        //5,当前执行结果是中止状态时（一般为人为中止）执行。
        aborted{

        }
        //6,当前完成状态为失败时执行。
        failure{

        }
        //7,当前完成状态为成功时执行。
        success{

        }
        //8,当前完成状态为不稳定时执行。
        unstable{

        }
        //9,清理条件块。不论当前完成状态是什么，在其他所有条件块执行完成后都执行。
        cleanup{

        }

    }

}